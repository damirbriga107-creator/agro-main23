<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DaorsAgro - Agricultural Financial Management Platform</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        function DashboardCard({ title, value, subtitle, icon }) {
            return (
                <div className="bg-white p-6 rounded-lg shadow-md border">
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-sm font-medium text-gray-600">{title}</p>
                            <p className="text-2xl font-bold text-gray-900">{value}</p>
                            {subtitle && <p className="text-xs text-gray-500">{subtitle}</p>}
                        </div>
                        <div className="text-2xl">{icon}</div>
                    </div>
                </div>
            );
        }
        
        function ServiceStatus({ service, status }) {
            const statusColor = status === 'healthy' ? 'text-green-600' : 'text-red-600';
            const statusBg = status === 'healthy' ? 'bg-green-100' : 'bg-red-100';
            
            return (
                <div className={`p-3 rounded-md ${statusBg} flex items-center justify-between`}>
                    <span className="font-medium text-gray-900">{service}</span>
                    <span className={`text-sm font-medium ${statusColor}`}>
                        {status === 'healthy' ? 'âœ“ Running' : 'âœ— Error'}
                    </span>
                </div>
            );
        }
        
        function App() {
            const [apiStatus, setApiStatus] = useState('connecting...');
            const [services, setServices] = useState({});
            const [financialData, setFinancialData] = useState(null);
            
            useEffect(() => {
                // Check API health
                fetch('http://localhost:3000/health')
                    .then(res => res.json())
                    .then(data => {
                        setApiStatus('connected');
                        return fetch('http://localhost:3000/api/health');
                    })
                    .then(res => res.json())
                    .then(data => {
                        setServices(data.services);
                    })
                    .catch(err => {
                        setApiStatus('error');
                        console.error('API Error:', err);
                    });
                
                // Fetch financial data
                fetch('http://localhost:3000/api/financial/dashboard')
                    .then(res => res.json())
                    .then(data => setFinancialData(data))
                    .catch(err => console.error('Financial API Error:', err));
            }, []);
            
            return (
                <div className="min-h-screen bg-gray-50">
                    <nav className="bg-green-600 text-white p-4">
                        <div className="container mx-auto flex items-center justify-between">
                            <h1 className="text-2xl font-bold">ðŸŒ± DaorsAgro</h1>
                            <div className="flex items-center space-x-4">
                                <span className="text-sm">Development Server</span>
                                <div className={`w-3 h-3 rounded-full ${apiStatus === 'connected' ? 'bg-green-400' : 'bg-red-400'}`}></div>
                            </div>
                        </div>
                    </nav>
                    
                    <div className="container mx-auto p-6">
                        <div className="mb-8">
                            <h2 className="text-3xl font-bold text-gray-900 mb-2">Agricultural Dashboard</h2>
                            <p className="text-gray-600">Live Development Environment - DaorsAgro Platform</p>
                        </div>
                        
                        {/* API Status */}
                        <div className="mb-8">
                            <h3 className="text-xl font-semibold mb-4">ðŸ”— Service Status</h3>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <ServiceStatus service="API Gateway" status={apiStatus === 'connected' ? 'healthy' : 'error'} />
                                {Object.entries(services).map(([service, status]) => (
                                    <ServiceStatus key={service} service={service.replace('-service', '')} status={status} />
                                ))}
                            </div>
                        </div>
                        
                        {/* Financial Dashboard */}
                        {financialData && (
                            <div className="mb-8">
                                <h3 className="text-xl font-semibold mb-4">ðŸ’° Financial Overview</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                    <DashboardCard
                                        title="Total Revenue"
                                        value={`$${financialData.totalRevenue?.toLocaleString()}`}
                                        subtitle="This month"
                                        icon="ðŸ’µ"
                                    />
                                    <DashboardCard
                                        title="Total Expenses"
                                        value={`$${financialData.totalExpenses?.toLocaleString()}`}
                                        subtitle="This month"
                                        icon="ðŸ’¸"
                                    />
                                    <DashboardCard
                                        title="Net Profit"
                                        value={`$${financialData.netProfit?.toLocaleString()}`}
                                        subtitle="This month"
                                        icon="ðŸ“ˆ"
                                    />
                                    <DashboardCard
                                        title="Profit Margin"
                                        value={`${financialData.profitMargin}%`}
                                        subtitle="Current"
                                        icon="ðŸ“Š"
                                    />
                                </div>
                            </div>
                        )}
                        
                        {/* Recent Transactions */}
                        {financialData?.transactions && (
                            <div className="mb-8">
                                <h3 className="text-xl font-semibold mb-4">ðŸ“‹ Recent Transactions</h3>
                                <div className="bg-white rounded-lg shadow-md overflow-hidden">
                                    <div className="px-6 py-4 border-b border-gray-200">
                                        <h4 className="text-lg font-medium">Transaction History</h4>
                                    </div>
                                    <div className="divide-y divide-gray-200">
                                        {financialData.transactions.map(transaction => (
                                            <div key={transaction.id} className="px-6 py-4 flex items-center justify-between">
                                                <div>
                                                    <p className="font-medium text-gray-900">{transaction.description}</p>
                                                    <p className="text-sm text-gray-500">{transaction.date}</p>
                                                </div>
                                                <div className={`text-lg font-semibold ${
                                                    transaction.amount > 0 ? 'text-green-600' : 'text-red-600'
                                                }`}>
                                                    {transaction.amount > 0 ? '+' : ''}${Math.abs(transaction.amount).toLocaleString()}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        {/* Development Info */}
                        <div className="bg-blue-50 border border-blue-200 rounded-lg p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-2">ðŸš€ Development Server Info</h3>
                            <div className="text-sm text-blue-800 space-y-2">
                                <p><strong>Backend API:</strong> http://localhost:3000</p>
                                <p><strong>Frontend:</strong> Static React Application</p>
                                <p><strong>Status:</strong> {apiStatus}</p>
                                <p><strong>Architecture:</strong> Microservices (Development Mode)</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>